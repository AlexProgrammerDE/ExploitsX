package me.bait.exploitfixer.gameplay;

import java.math.BigDecimal;
import java.math.RoundingMode;

import org.bukkit.Bukkit;
import org.bukkit.entity.Player;

import me.bait.exploitfixer.ExploitFixer;
import me.bait.exploitfixer.util.API;
import me.clip.placeholderapi.expansion.PlaceholderExpansion;

//THIS WORK IS UNDER EXCLUSIVE COPRIGHT FOR BAITCORP LABS. DISTRIBUTION, MODIFICATION, SELLING, OR SHARING WITHOUT EXPLICIT PERMISSION FROM BAITCORP LABS IS STRICTLY PROHIBITED.
//ExploitsX Sebastian Giheta 2019-2020

public class Placeholder extends PlaceholderExpansion {

	public static double round(double value, int places) {
		if (places < 0)
			throw new IllegalArgumentException();
		BigDecimal bd = new BigDecimal(value);
		bd = bd.setScale(places, RoundingMode.HALF_UP);
		return bd.doubleValue();
	}

	@Override
	public String getAuthor() {
		return "baitcorp";
	}

	@Override
	public String getIdentifier() {
		return "ef";
	}

	@Override
	public String getPlugin() {
		return null;
	}

	@Override
	public String getVersion() {
		return ExploitFixer.getPlugin().getDescription().getVersion();
	}

	@Override
	public String onPlaceholderRequest(Player p, String identifier) {
		if (identifier.equals("tps")) {
			Double TPS = (API.getTps());
			Double intTPS = Double.valueOf(round(TPS.doubleValue(), 2));
			if (intTPS.doubleValue() > 19.5D)
				return "�a20.0*";
			if (intTPS.doubleValue() <= 19.5D && intTPS.doubleValue() > 15.0D)
				return "�a" + String.valueOf(intTPS);
			if (intTPS.doubleValue() <= 19.5D && intTPS.doubleValue() <= 15.0D && intTPS.doubleValue() > 12.0D)
				return "�e" + String.valueOf(intTPS);
			if (intTPS.doubleValue() <= 19.5D && intTPS.doubleValue() <= 15.0D && intTPS.doubleValue() <= 12.0D
					&& intTPS.doubleValue() > 6.0D)
				return "�c" + String.valueOf(intTPS);
			if (intTPS.doubleValue() <= 19.5D && intTPS.doubleValue() <= 15.0D && intTPS.doubleValue() <= 12.0D
					&& intTPS.doubleValue() <= 6.0D)
				return "�4" + String.valueOf(intTPS);
		}
		if (identifier.equals("online")) {
			int players = Bukkit.getServer().getOnlinePlayers().size();
			return String.valueOf(players);
		}
		if (identifier.equals("uptime")) {
			return String.valueOf(API.GetFormattedInterval(API.timeSeconds));
		}
		if (p == null)
			return "";
		return null;
	}
}
