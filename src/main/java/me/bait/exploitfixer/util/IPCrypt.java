package me.bait.exploitfixer.util;

import java.io.File;
import java.io.IOException;

import org.bukkit.Bukkit;
import org.bukkit.configuration.InvalidConfigurationException;
import org.bukkit.configuration.file.YamlConfiguration;
import org.bukkit.entity.Player;
import org.bukkit.scheduler.BukkitRunnable;

import me.bait.exploitfixer.ExploitFixer;

//-- // WARNING \\ -- 
//-- THIS WORK IS UNDER EXCLUSIVE COPRIGHT FOR BAITCORP LABS. DISTRIBUTION, MODIFICATION, SELLING, OR SHARING WITHOUT EXPLICIT PERMISSION FROM BAITCORP LABS IS STRICTLY PROHIBITED.
//-- THIS PROGRAM IS LICENSED FOR MODIFICATION TO AND ONLY TO: "BAITCORP LABS" [FR], "CCHOST PARIS" [FR].
//-- 
//-- DECOMPILING, COPYING OR REDISTRIBUTING THIS CODE IS A CRIME. IF YOU HAVE ANY QUESTIONS OR CONCERNS
//-- THEY MUST BE VOICED DIRECTLY TO BAITCORP EXECUTIVES BEFORE PERSONAL ACTION.
//-- 
//-- ExploitsX Sebastian Giheta 2019-2020
//-- //         \\ -- 

public class IPCrypt {

	public static void quit(Player p) {
		new Thread(new Runnable() {
			@Override
			public void run() {
				new BukkitRunnable() {
					@Override
					public void run() {
						String uuid = p.getUniqueId().toString();
						if (ExploitFixer.getPlugin().getConfig().getBoolean("debug") == true) {
							Bukkit.getLogger().info("ExploitsX is encrypting the IP of: " + p);
						}
						File dir = new File("plugins/Essentials/userdata/");
						if (dir.exists()) {
							File f = new File("plugins/Essentials/userdata/" + uuid + ".yml");
							if (f.exists()) {
								YamlConfiguration save = new YamlConfiguration();
								try {
									save.load(f);
								} catch (IOException | InvalidConfigurationException er) {
									er.printStackTrace();
								}
								save.set("ipAddress", "127.0.0.1");
								try {
									save.save(f);
								} catch (IOException er) {
									er.printStackTrace();
								}
							}
						}
					}
				}.runTaskLater(ExploitFixer.getPlugin(), 10);
			}
		}).start();
	}
}
